---
title: "k/k#135495: The Last Piece of Async Preemption Optimization"
date: 2025-12-12T00:51:43+09:00
draft: false
---

{{< github "https://github.com/kubernetes/kubernetes/pull/135495" >}}

An optimization that skips deleting the last Pod when preempting N Pods if the first N-1 Pods deletions have failed.
The early termination when N-1 async preemptions fail was already implemented, so this was the remaining optimization in that area.

{{< alert tip >}}
If the first N-1 deletions have already failed, there's no point in deleting just the last one. It's meaningless because even if we fill NNN, it will still result in insufficient resources and add scheduling overhead.
{{< /alert >}}

While reading through this, I found some areas in the metrics that could be improved, so I created an issue.
{{< github "https://github.com/kubernetes/kubernetes/issues/135717" >}}

I also took the opportunity to read the [Async Preemption KEP](https://github.com/kubernetes/enhancements/tree/b83d33122e3f36dd5f70cd19deb41e208764b1de/keps/sig-scheduling/4832-async-preemption). Indeed, preemption is slow.
{{< github-code "https://github.com/kubernetes/kubernetes/blob/342da505bdefbd849b808cca3cb76c24a993025f/test/integration/scheduler_perf/config/performance-config.yaml#L621-L645" >}}

I felt that having a FeatureGate makes features easier to understand.
